<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OS Travel & Tours Chatbot</title>
  <style>
    :root{
      --brand:#0078ff;
      --bg:#ffffff;
      --muted:#f6f7fb;
      --text:#1f2937;
      --soft:#e5efff;
    }
    *{box-sizing:border-box}
    .chatbot-button{
      position:fixed;bottom:20px;right:20px;width:64px;height:64px;border-radius:50%;
      background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;
      font-size:28px;cursor:pointer;box-shadow:0 10px 25px rgba(0,0,0,.18);z-index:1000
    }
    .chatbot-container{
      position:fixed;bottom:96px;right:20px;width:380px;height:560px;background:var(--bg);
      border-radius:16px;box-shadow:0 20px 50px rgba(0,0,0,.22);display:none;flex-direction:column;
      overflow:hidden;font-family:Inter,system-ui,Arial,sans-serif;z-index:1000;border:1px solid #e5e7eb
    }
    .chatbot-header{
      background:linear-gradient(135deg,var(--brand),#2b8cff);color:#fff;padding:14px 16px;
      font-weight:700;text-align:center;letter-spacing:.2px
    }
    .chatbot-messages{flex:1;padding:12px;overflow-y:auto;font-size:14px;background:var(--muted)}
    .chatbot-input{display:flex;border-top:1px solid #e5e7eb;background:#fff}
    .chatbot-input input{flex:1;padding:12px;border:none;outline:none;font-size:14px}
    .chatbot-input button{padding:12px 16px;border:none;background:var(--brand);color:#fff;cursor:pointer;font-weight:600}

    .bot-message,.user-message{
      margin:8px 0;padding:10px 12px;border-radius:10px;max-width:85%;clear:both;white-space:pre-wrap;line-height:1.45
    }
    .bot-message{background:#fff;float:left;border:1px solid #eef2ff}
    .user-message{background:var(--brand);color:#fff;float:right}

    .pill{display:inline-flex;align-items:center;padding:6px 10px;border-radius:999px;background:var(--soft);
      color:var(--brand);font-size:12px;font-weight:600;margin:2px 6px 0 0;border:1px solid #dbe8ff;cursor:pointer}
    .pill:hover{background:#cfe0ff}

    .country-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:6px}
    .country-btn{
      border:1px solid #e5e7eb;border-radius:10px;padding:10px;background:#fff;cursor:pointer;text-align:left;
      font-weight:600;color:var(--text);transition:transform .06s ease, box-shadow .06s ease
    }
    .country-btn:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.08)}
    .muted{color:#6b7280}
    .kicker{font-size:12px;color:#6b7280;margin-bottom:4px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
    .tag{background:#f3f4f6;border:1px solid #e5e7eb;border-radius:8px;padding:4px 8px;font-size:12px}
    .quick{display:inline-flex;gap:8px;margin-top:8px}
    .quick button{border:1px solid #e5e7eb;background:#fff;border-radius:8px;padding:6px 10px;cursor:pointer}
    .quick button:hover{background:#f9fafb}
  </style>
</head>
<body>

  <!-- Floating Button -->
  <div class="chatbot-button" onclick="toggleChat()">üí¨</div>

  <!-- Chatbox -->
  <div class="chatbot-container" id="chatbot">
    <div class="chatbot-header">OS Travel & Tours</div>
    <div class="chatbot-messages" id="messages"></div>
    <div class="chatbot-input">
      <input type="text" id="userInput" placeholder="Ask about visa price, documents, processing‚Ä¶"/>
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

  <script>
    // ======================== Config =========================
    const API_KEY = "AIzaSyCduUjLNhVTo8QVBO6Dz5kpi7oFk99shX4"; // ‚Üê put your Gemini key here
    const CONTACT = `Located in: Alay Plaza
Address: Office # 3, Aaly Plaza, Fazal-e-Haq Road, Block E G 6/2 Blue Area, Islamabad, 44000
Phone: 051-2120700-701,0333-5542877`;

    // ===================== Data (from ostravels.com) =====================
    // Fees/processing pulled where available on site pages; otherwise "Contact for latest".
    // Sources: Visa list + country subpages + Schengen file pages.
    const visaData = {
      // Asia (eVisa / direct)
      "Malaysia": { type:"eVisa", price:"  18000 /Pkr", processing:"7‚Äì10 working days", stay:"varies", docs:["Passport copy","CNIC","Bank statement","Photos"], src:"/visa/" },
      "Singapore": { type:"Embassy / online submission", price:" 18000 /Pkr", processing:" 7-10  Working Days", stay:"varies", docs:["Passport","Itinerary","Proof of funds","Photo","Invitation (if any)"], src:"/visa/singapore-visa/" },
      "Hong Kong": { type:"Online via HK Immigration", price:"   230/HK Dollars ", processing:"Up to 4 weeks", stay:"varies", docs:["Online form","Passport","Financial proof"], src:"/schengen-visa-file-processing/hong-kong-visa/" },
      "Indonesia": { type:"eVisa/VOA (subject to policy)", price:"   105 / USD ", processing:"     03-05  Working Days  { Varies Case To Case }", stay:"varies", docs:["Passport","Photo","Travel details"], src:"/visa/" },
      "Thailand": { type:"Tourist visa / eVOA", price:"15000 / Pkr ", processing:"08 Working Days ", stay:"varies", docs:["Passport","Photo","Hotel & Ticket","Funds"], src:"/visa/thailand-visa/" },
      "China": { type:"Embassy", price:"Jerry‚Äôs Service Charges : 6500  /Pkr ", processing:"15  Working Days ", stay:"varies", docs:["Passport","Photo","Itinerary","Bank Statement"], src:"/visa/" },
      "Vietnam": { type:"eVisa", price:" 25,000 /Pkr", processing:"07  Working Days ", stay:"varies", docs:["Passport","Photo"], src:"/visa/" },
      "Cambodia": { type:"eVisa", price:"  20,000 /Pkr", processing:"  03 working days", stay:"varies", docs:["Online application","Photo","Passport"], src:"/visa/cambodia-visa/" },
      "Nepal": { type:"Embassy/VOA (policy dependent)", price:" 15,000 /Pkr ", processing:"03 to 5  Working Days ", stay:"varies", docs:["Passport","Photo"], src:"/visa/" },
      "Sri Lanka": { type:"ETA", price:"  15000 / Pkr ", processing:"   14 Working Days ", stay:"varies", docs:["Passport","Photo"], src:"/visa/" },
      "Philippines": {
        type:"Embassy",
        price:"PKR 12,000 (SE, 3 months) / PKR 20,000 (ME, 6 months) / PKR 26,600 (ME, 1 year)",
        processing:"Contact for latest",
        stay:"varies by category",
        docs:["Passport","Photos","Form","Supporting docs"],
        src:"/schengen-visa-file-processing/philippine-visa/"
      },
      "Saudi Arabia": { type:"eVisa (special conditions) / Embassy", price:" 115,000 /Pkr", processing:"05 to 7  Working Days", stay:"varies", docs:["Passport","Photo","Support docs"], src:"/visa/saudi-arabia-visa/" },
      "Azerbaijan": {
        type:"eVisa",
        price:"8000 /Pkr",
        processing:"10-15  Working Days",
        stay:"Single entry, 30 days",
        docs:["Online form","Passport scan","ID card scan"],
        src:"/visa/azerbaijan-visa/"
      },
      "Uzbekistan": {
        type:"Embassy",
        price:"USD 90 (normal telex) / USD 110 (urgent)",
        processing:"12-15  Working Days",
        stay:"30 days (tourist)",
        docs:["Passport (6+ months)","Form","Itinerary"],
        src:"/visa/uzbekistan-visa/"
      },
      "Tajikistan": { type:"Embassy / eVisa portal", price:"  10,500 / Pkr", processing:"07-10  Working Days ", stay:"varies", docs:["Application","Passport","(eVisa option available)"], src:"/visa/tajikistan-visa/" },
      "Kyrgyzstan": {
        type:"Embassy / eVisa (policy dependent)",
        price:"  250/- Usd ",
        processing:" Contact for more",
        stay:"varies",
        docs:["Application","Passport (6+ months)","Itinerary","Proof of funds","Invitation (if applicable)","Fee receipt"],
        src:"/visa/kyrgyzstan-visa/"
      },
      "Kazakhstan": {
        type:"Embassy",
        price:"  60 /USD ",
        processing:"    03 to 5  Working Days ",
        stay:"varies",
        docs:["Passport (6+ months)","4 Photos (35x50)","Online form","Bank statement","Visa request letter","Return ticket","Hotel","Insurance","Visa support number"],
        src:"/visa/kazakhstan/"
      },
      "Egypt": { type:"eVisa / Embassy", price:"20000 /Pkr ", processing:"   4- 6 Weeks  Working Days { Varies Case to Case }", stay:"varies", docs:["Passport","Photo","Itinerary"], src:"/visa/" },
      "Turkey": { type:"eVisa / Embassy", price:"    55,000 /Pkr ", processing:" 15 to 18  Working Days", stay:"varies", docs:["Passport","Photo"], src:"/visa/" },

      // Schengen / File Processing group
      "France": fileItem(),
      "Spain": fileItem(),
      "United Kingdom (UK)": fileItem(),
      "United States (USA)": fileItem(),
      "Australia": fileItem(),
      "Canada": fileItem(),
      "Belgium": fileItem(),
      "Netherlands": fileItem(),
      "Poland": fileItem(),
      "Germany": fileItem(),
      "Italy": fileItem(),
      "Hungary": fileItem(),
      "Greece": fileItem(),
      "Czech Republic": fileItem(),
      "Switzerland": fileItem(),
      "Portugal": fileItem(),
      "Denmark": fileItem(),
      "Sweden": fileItem(),
      "Norway": fileItem()
    };

    function fileItem(){
      return {
        type:"Visa File Processing (Embassy)",
        price:"Embassy fee varies ‚Äì contact for latest",
        processing:"Typically 2‚Äì4+ weeks (varies by embassy/time of year)",
        stay:"as per visa category",
        docs:["Application form","Passport","Photos","Financials","Travel itinerary","Cover/Invitation (if any)"],
        src:"/schengen-visa-file-processing/"
      }
    }

    // ===================== UI / Boot =====================
    let currentCountry = null;
    const messages = document.getElementById("messages");

    function toggleChat(){
      const chat = document.getElementById("chatbot");
      const firstOpen = chat.style.display !== "flex";
      chat.style.display = firstOpen ? "flex" : "none";
      if(firstOpen){ boot(); }
    }

    function boot(){
      addBot(`üëã Hello! I‚Äôm your travel assistant for OS Travel & Tours.
Ask me about visa price, documents, processing time ‚Äî or click a country below.`);
      showCountryGrid();
      addBot(`üìù Tip: I only handle **tourist/visit visas, tickets & packages**. For work/study visas we currently do not deal.`);
      addBot(`‚òéÔ∏è Contact:\n${CONTACT}`);
    }

    function addBot(text){ addMessage(text,"bot"); }
    function addUser(text){ addMessage(text,"user"); }
    function addMessage(text, who){
      const div = document.createElement("div");
      div.className = who === "bot" ? "bot-message" : "user-message";
      div.innerText = text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    function showCountryGrid(){
      const wrap = document.createElement("div");
      wrap.className = "bot-message";
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `<div class="kicker">üåç Countries we serve</div>`;
      const grid = document.createElement("div");
      grid.className = "country-grid";
      Object.keys(visaData).forEach(name=>{
        const btn = document.createElement("button");
        btn.className="country-btn";
        btn.innerHTML = `${name}`;
        btn.onclick = ()=> showCountryDetail(name);
        grid.appendChild(btn);
      });
      card.appendChild(grid);
      wrap.appendChild(card);
      messages.appendChild(wrap);
      messages.scrollTop = messages.scrollHeight;
    }

    function showCountryDetail(name){
      currentCountry = name;
      const d = visaData[name];
      const block = [
        `üìå ${name} ‚Äî ${d.type}`,
        d.stay ? `üß≠ Stay/Validity: ${d.stay}` : null,
        `üí≥ Fee: ${d.price}`,
        `‚è≥ Processing: ${d.processing}`,
        d.docs?.length ? `üìë Documents: ${d.docs.join(", ")}` : null,
        d.src ? `üîó Source: ostravels.com${d.src}` : null
      ].filter(Boolean).join("\n");
      addBot(block);

      // quick buttons
      const q = document.createElement("div");
      q.className="bot-message";
      q.innerHTML = `<div class="quick">
        <button onclick="quickAsk('price')">Price</button>
        <button onclick="quickAsk('processing')">Processing time</button>
        <button onclick="quickAsk('documents')">Documents</button>
        <button onclick="quickAsk('contact')">Contact</button>
      </div>`;
      messages.appendChild(q); messages.scrollTop = messages.scrollHeight;
    }

    function quickAsk(kind){
      if(!currentCountry) return;
      const d = visaData[currentCountry];
      if(kind==="price") addBot(`üí≥ ${currentCountry} visa fee: ${d.price}`);
      else if(kind==="processing") addBot(`‚è≥ ${currentCountry} processing time: ${d.processing}`);
      else if(kind==="documents") addBot(`üìë ${currentCountry} required documents: ${d.docs?.join(", ") || "Contact for checklist"}`);
      else if(kind==="contact") addBot(`‚òéÔ∏è ${CONTACT}`);
    }

    // ===================== NLP-ish handling =====================
    function textIncludesAny(s, arr){ return arr.some(w => s.includes(w)); }

    async function sendMessage(){
      const input = document.getElementById("userInput");
      const original = input.value.trim();
      const msg = original.toLowerCase();
      if(!msg) return;
      addUser(original);
      input.value = "";

      // 1) block work/study visa
      if(textIncludesAny(msg,["work","job","employment","study","student"])){
        addBot("‚ö†Ô∏è Sorry, we currently do not deal with work or study visas. We only assist with tourist/visit visas, tickets, packages & Umrah.");
        return;
      }

      // 2) contact/location
      if(textIncludesAny(msg,["address","location","phone","contact","office","number"])){
        addBot(`üìç Contact details:\n${CONTACT}`);
        return;
      }

      // 3) country mentioned directly
      for(const name of Object.keys(visaData)){
        const key = name.toLowerCase();
        if(msg.includes(key)){ showCountryDetail(name); return; }
      }

      // 4) follow-up using memory
      if(currentCountry){
        const d = visaData[currentCountry];
        if(textIncludesAny(msg,["price","cost","fee","charges"])) { addBot(`üí≥ ${currentCountry} visa fee: ${d.price}`); return; }
        if(textIncludesAny(msg,["processing","time","days","duration"])) { addBot(`‚è≥ ${currentCountry} processing time: ${d.processing}`); return; }
        if(textIncludesAny(msg,["document","documents","docs","requirements","requirement","paper"])) { addBot(`üìë ${currentCountry} required documents: ${d.docs?.join(", ") || "Contact for checklist"}`); return; }
        if(textIncludesAny(msg,["validity","stay","entry"])) { addBot(`üß≠ ${currentCountry} stay/validity: ${d.stay || "Varies by category"}`); return; }
      }

      // 5) help user choose
      if(textIncludesAny(msg,["country","list","menu","options","visa"])) {
        addBot("Here are the countries we deal in ‚Äî tap to view:");
        showCountryGrid(); return;
      }

      // 6) Gemini fallback for general travel queries
      addBot("‚Ä¶");
      try{
        const res = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`,
          {
            method:"POST",
            headers:{ "Content-Type":"application/json" },
            body:JSON.stringify({
              contents:[{parts:[{text:
`You are OS Travel & Tours Assistant.
Only answer about tourist/visit visas, air tickets, travel packages, Umrah.
If user asks about work or study visas: politely say we do not deal.
Keep answers short, friendly, and Pakistan-context aware.
User: ${original}`}]}]
            })
          }
        );
        const data = await res.json();
        const reply = data?.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I didn‚Äôt get that. Please pick a country from the list.";
        messages.lastChild.innerText = reply;
      }catch(e){
        console.error(e);
        messages.lastChild.innerText = "‚ö†Ô∏è System is busy. Please call us at 051-2120700-701,0333-5542877";
      }
    }
  </script>
</body>
</html>
